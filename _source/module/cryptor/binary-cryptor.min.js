function missZero(r){if(r){for(var t=r.charCodeAt().toString(2),e=t.length,n=16-e;n>0;)t="0"+t,n--;return t}}function toBinStr(r){if(r){for(var t="",e=0;e<r.length;e++)t+=missZero(r[e]);return t}}function toBinArr(r){if(r){for(var t=[],e=0;e<r.length;e++)t[e]=missZero(r[e]);return t}}function binToStr(r){if(r){r=r.replace(/[^0-1]/gim,""),r=r.replace(/\s+/g,""),r=r.match(/.{1,16}/g).join(" ");var t=r.split(" "),e=[];for(i=0;i<t.length;i++)e.push(String.fromCharCode(parseInt(t[i],2)));return e.join("")}}function randomBinStr(){return Math.round(Math.random()*Math.pow(10,16)).toString(2)}function inShiftVal(r,t){if(r&&t){t=t.replace(/[^0-1]/gim,"");var e=toBinStr(r).replace(/0/gi,"").length;t.length<e?e%t.length!=0?e%=t.length:(e=toBinStr(r.charAt(0)).replace(/0/gi,"").length,e>=16&&(e=13)):t.length==e&&(e=toBinStr(r.charAt(0)).replace(/0/gi,"").length,e>=16&&(e=13));var n=t.substr(0,t.length-e),i=t.substr(-e),a=i+n;return a}}function outShiftVal(r,t){if(r&&t){t=t.replace(/[^0-1]/gim,"");var e=toBinStr(r).replace(/0/gi,"").length;t.length<e?e%t.length!=0?e%=t.length:(e=toBinStr(r.charAt(0)).replace(/0/gi,"").length,e>=16&&(e=13)):t.length==e&&(e=toBinStr(r.charAt(0)).replace(/0/gi,"").length,e>=16&&(e=13));var n=t.substr(0,e),i=t.substr(e,t.length),a=i+n;return a}}function injectTrash(r,t){if(r&&t){t=t.replace(/[^0-1]/gim,"");for(var e=toBinArr(r),n=t,i=e[0].replace(/0/gi,"").length,a="";n.length>i;)$(e).each(function(r,t){var e=n.length,i=t.replace(/0/gi,"").length;if(!(e>i))return!1;var l=n.substr(0,i),g=n.substring(i,e),o=randomBinStr().substr(0,i);a+=l+o,n=g});return a+=n}}function deleteTrash(r,t){if(r&&t){t=t.replace(/[^0-1]/gim,"");for(var e=toBinArr(r),n=t,i=e[0].replace(/0/gi,"").length,a="";n.length>2*i;)$(e).each(function(r,t){var e=n.length,i=t.replace(/0/gi,"").length;if(!(e>2*i))return!1;var l=n.substr(0,2*i),g=n.substring(2*i,e);a+=l.substr(0,i),n=g});return a+=n}}function reverseBits(r,t){if(r&&t){t=t.replace(/[^0-1]/gim,"");for(var e=toBinArr(r),n=t,i=e[0].replace(/0/gi,"").length,a="";n.length>i;)$(e).each(function(r,t){var e=n.length,i=t.replace(/0/gi,"").length;if(!(e>i))return!1;var l=n.substr(0,i-1),g=n.substring(i,e),o=n.charAt(i-1);if("0"==o)var h="1";else var h="0";a+=l+h,n=g});return a+=n}}function binaryCode(r,t){if(r&&t){t=t.replace(/[^0-1]/gim,"");for(var e=toBinStr(r),n=e.split(""),i=t,a="";i.length>0;)$(n).each(function(r,t){if(!(i.length>0))return!1;var e=i.charAt(0),n=i.substr(1,i.length);if(e==t)var l="1";else var l="0";a+=l,i=n});return a}}function coding(r,t){if(r&&t){var e=toBinStr(t),n=inShiftVal(r,e),i=injectTrash(r,n),a=reverseBits(r,i),l=binaryCode(r,a),g=l;return g}}function decoding(r,t){if(r&&t){t=t.replace(/[^0-1]/gim,"");var e=binaryCode(r,t),n=reverseBits(r,e),i=deleteTrash(r,n),a=outShiftVal(r,i),l=binToStr(a);return l}}