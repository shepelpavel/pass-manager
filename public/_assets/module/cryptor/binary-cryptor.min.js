function missZero(r){if(r){for(var t=r.charCodeAt().toString(2),e=t.length,n=16-e;n>0;)t="0"+t,n--;return t}}function toBinStr(r){if(r){for(var t="",e=0;e<r.length;e++)t+=missZero(r[e]);return t}}function toBinArr(r){if(r){for(var t=[],e=0;e<r.length;e++)t[e]=missZero(r[e]);return t}}function binToStr(r){if(r){r=r.replace(/[^0-1]/gim,""),r=r.replace(/\s+/g,""),r=r.match(/.{1,16}/g).join(" ");var t=r.split(" "),e=[];for(i=0;i<t.length;i++)e.push(String.fromCharCode(parseInt(t[i],2)));return e.join("")}}function reverseString(r){var t="";return""!=r&&(t=reverseString(r.substr(1))+r.charAt(0)),t}function trashBinStr(r){var t=reverseString(toBinStr(r.toString(10)));return t}function inShiftVal(r,t){if(r&&t){t=t.replace(/[^0-1]/gim,"");var e=toBinStr(r).replace(/0/gi,"").length;t.length<e?e%t.length!=0?e%=t.length:(e=toBinStr(r.charAt(0)).replace(/0/gi,"").length,e>=16&&(e=13)):t.length==e&&(e=toBinStr(r.charAt(0)).replace(/0/gi,"").length,e>=16&&(e=13));var n=t.substr(0,t.length-e),i=t.substr(-e),a=i+n;return a}}function outShiftVal(r,t){if(r&&t){t=t.replace(/[^0-1]/gim,"");var e=toBinStr(r).replace(/0/gi,"").length;t.length<e?e%t.length!=0?e%=t.length:(e=toBinStr(r.charAt(0)).replace(/0/gi,"").length,e>=16&&(e=13)):t.length==e&&(e=toBinStr(r.charAt(0)).replace(/0/gi,"").length,e>=16&&(e=13));var n=t.substr(0,e),i=t.substr(e,t.length),a=i+n;return a}}function injectTrash(r,t){if(r&&t){t=t.replace(/[^0-1]/gim,"");for(var e=toBinArr(r),n=t,i=e[0].replace(/0/gi,"").length,a="";n.length>i;)$(e).each(function(r,t){var e=n.length,i=t.replace(/0/gi,"").length;if(!(e>i))return!1;var g=n.substr(0,i),l=n.substring(i,e),h=trashBinStr(l.length).substr(0,i);a+=g+h,n=l});return a+=n}}function deleteTrash(r,t){if(r&&t){t=t.replace(/[^0-1]/gim,"");for(var e=toBinArr(r),n=t,i=e[0].replace(/0/gi,"").length,a="";n.length>2*i;)$(e).each(function(r,t){var e=n.length,i=t.replace(/0/gi,"").length;if(!(e>2*i))return!1;var g=n.substr(0,2*i),l=n.substring(2*i,e);a+=g.substr(0,i),n=l});return a+=n}}function reverseBits(r,t){if(r&&t){t=t.replace(/[^0-1]/gim,"");for(var e=toBinArr(r),n=t,i=e[0].replace(/0/gi,"").length,a="";n.length>i;)$(e).each(function(r,t){var e=n.length,i=t.replace(/0/gi,"").length;if(!(e>i))return!1;var g=n.substr(0,i-1),l=n.substring(i,e),h=n.charAt(i-1);if("0"==h)var o="1";else var o="0";a+=g+o,n=l});return a+=n}}function binaryCode(r,t){if(r&&t){t=t.replace(/[^0-1]/gim,"");for(var e=toBinStr(r),n=e.split(""),i=t,a="";i.length>0;)$(n).each(function(r,t){if(!(i.length>0))return!1;var e=i.charAt(0),n=i.substr(1,i.length);if(e==t)var g="1";else var g="0";a+=g,i=n});return a}}function coding(r,t){if(r&&t){var e=toBinStr(t),n=inShiftVal(r,e),i=injectTrash(r,n),a=reverseBits(r,i),g=binaryCode(r,a),l=g;return l}}function decoding(r,t){if(r&&t){t=t.replace(/[^0-1]/gim,"");var e=binaryCode(r,t),n=reverseBits(r,e),i=deleteTrash(r,n),a=outShiftVal(r,i),g=binToStr(a);return g}}